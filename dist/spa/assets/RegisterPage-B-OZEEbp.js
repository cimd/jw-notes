import{Q as d,a as S}from"./QCardActions-Dq7syfRn.js";import{Q as m}from"./QInput-aOKcImwq.js";import{a as q,Q as c}from"./QBtn-LIf1TL9v.js";import{Q as b}from"./QForm-CeXXneY4.js";import{u as V,a as k}from"./use-dark-BVUz_ulx.js";import{m as y,g as Q,q as f,s as p,a0 as A,d as E,_ as M,o as B,c as D,u as l,K as o,a2 as P,J as n,L}from"./index-CPXBor41.js";import{h as U,b as z}from"./render-D-1utwwR.js";import{Q as v}from"./QDialog-BSwpd-ms.js";import{u as F,a as N}from"./QSpinner-Zq-zkTSh.js";import{Q as x}from"./QPage-CW88zJPQ.js";import{C as H}from"./ClosePopup-BmUXs1l2.js";import"./isTypedArray-V6sIBVz1.js";import{A as I,M as O}from"./Api-DXgXXLek.js";import{r as u,m as $,e as R,s as T}from"./index-BBPnM2xW.js";import{http as J,auth as j}from"./apis-DQM09prS.js";import{u as g}from"./Auth-BgP8Y6hw.js";import{a as K}from"./http-CAOryOOa.js";import"./use-file-dom-props-6q2ASvdB.js";import"./focus-manager-BJWzFvJg.js";import"./use-key-composition-LfE98imi.js";import"./dom-D0uG0Gv7.js";import"./vm-B61G6sTM.js";import"./use-prevent-scroll-uF1fyu4N.js";import"./scroll-DuwlRRaI.js";import"./use-timeout-b2Ost2wr.js";import"./focusout-R0Pxo-jF.js";import"./use-model-toggle-B0lJUWJs.js";import"./Action-BeMcUDL_.js";import"./index-kbbxJ5lx.js";const{Axios:Pe,AxiosError:G,CanceledError:Le,isCancel:Ue,CancelToken:ze,VERSION:Fe,all:Ne,Cancel:xe,isAxiosError:He,spread:Ie,toFormData:Oe,AxiosHeaders:Re,HttpStatusCode:Te,formToJSON:Je,getAdapter:je,mergeConfig:Ke}=K,C=y({name:"QCard",props:{...V,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(e,{slots:r}){const{proxy:{$q:a}}=Q(),i=k(e,a),s=f(()=>"q-card"+(i.value===!0?" q-card--dark q-dark":"")+(e.bordered===!0?" q-card--bordered":"")+(e.square===!0?" q-card--square no-border-radius":"")+(e.flat===!0?" q-card--flat no-shadow":""));return()=>p(e.tag,{class:s.value},U(r.default))}}),W=y({name:"QAvatar",props:{...F,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(e,{slots:r}){const a=N(e),i=f(()=>"q-avatar"+(e.color?` bg-${e.color}`:"")+(e.textColor?` text-${e.textColor} q-chip--colored`:"")+(e.square===!0?" q-avatar--square":e.rounded===!0?" rounded-borders":"")),s=f(()=>e.fontSize?{fontSize:e.fontSize}:null);return()=>{const h=e.icon!==void 0?[p(q,{name:e.icon})]:void 0;return p("div",{class:i.value,style:a.value},[p("div",{class:"q-avatar__content row flex-center overflow-hidden",style:s.value},z(r.default,h))])}}});class w extends I{resource="users";constructor(){super()}static me(){const r=new w;return new Promise((a,i)=>{J.get("/api/v1/users/me").then(async s=>{r.retrieved(s.data),a(s.data)}).catch(s=>{r.retrievingError(s),console.error(s),i(s)})})}retrieved(r){console.log(r);const a=g();a.user=r.data}stored(r){console.log(r);const a=g();a.user=r.data,j.token=r.token}updated(r){console.log(r);const a=g();a.user=r.data}}class X extends O{api=w;model=A({id:void 0,created_at:void 0,updated_at:void 0,deleted_at:void 0,name:void 0,email:void 0,password:void 0,passwordConfirmation:void 0,token:void 0});constructor(r){super(),this.factory(r),super.initValidations()}validations=f(()=>({model:{name:{required:u,minLength:$(8)},email:{email:R,required:u},password:{required:u,minLengthValue:$(6)},passwordConfirmation:{required:u,sameAsPassword:T(this.model.password)}}}))}const Y=E({setup(){return{user:new X}},data(){return{open:!0,showErrorDialog:!1,errorMessage:""}},methods:{onBack(){this.$router.go(-1)},async submitForm(){if(this.user.$validate(),console.log(this.user.$model),!this.user.$invalid)try{const{actioned:e,model:r}=await this.user.save();console.log(e,r),this.$router.push({path:"/"})}catch(e){const r=new G(e).message.error.error.error.response;console.error("#postForm","error",r),r.status===422?(this.errorMessage="",Object.keys(r.data.error).forEach((a,i)=>{r.data.error[a].forEach(s=>{this.errorMessage+=s+" "}),this.errorMessage+="<br><br>"})):this.errorMessage="Unknown error",this.showErrorDialog=!0}}}}),Z=n("div",{id:"register-form-title",class:"text-h6"},"Register",-1),_={class:"q-pa-md"},ee={class:"q-gutter-y-md column",style:{"max-width":"400px"}},re=n("div",{class:"text-h6",style:{display:"inline","margin-left":"10px"}},"Sorry, an error happened",-1),oe=["innerHTML"];function ae(e,r,a,i,s,h){return B(),D(x,null,{default:l(()=>[o(v,{modelValue:e.open,"onUpdate:modelValue":r[4]||(r[4]=t=>e.open=t),persistent:""},{default:l(()=>[o(C,{style:{width:"400px"}},{default:l(()=>[o(d,null,{default:l(()=>[Z]),_:1}),o(d,{class:"q-pt-none"},{default:l(()=>[o(b,{ref:"registerForm",onSubmit:P(e.submitForm,["prevent"])},{default:l(()=>[n("div",_,[n("div",ee,[o(m,{ref:"name",modelValue:e.user.model.name,"onUpdate:modelValue":r[0]||(r[0]=t=>e.user.model.name=t),error:e.user.$model.name.$error,"error-message":e.user.$model.name.$errors[0]?.$message,label:"Full Name",name:"name",outlined:""},null,8,["modelValue","error","error-message"]),o(m,{ref:"email",modelValue:e.user.model.email,"onUpdate:modelValue":r[1]||(r[1]=t=>e.user.model.email=t),error:e.user.$model.email.$error,"error-message":e.user.$model.email.$errors[0]?.$message,label:"E-Mail Address",name:"email",outlined:""},null,8,["modelValue","error","error-message"]),o(m,{ref:"password",modelValue:e.user.model.password,"onUpdate:modelValue":r[2]||(r[2]=t=>e.user.model.password=t),error:e.user.$model.password.$error,"error-message":e.user.$model.password.$errors[0]?.$message,label:"Password",name:"password",outlined:"",type:"password"},null,8,["modelValue","error","error-message"]),o(m,{ref:"passwordConfirmation",modelValue:e.user.model.passwordConfirmation,"onUpdate:modelValue":r[3]||(r[3]=t=>e.user.model.passwordConfirmation=t),error:e.user.$model.passwordConfirmation.$error,"error-message":e.user.$model.passwordConfirmation.$errors[0]?.$message,label:"Confirm Password",name:"passwordConfirmation",outlined:"",type:"password"},null,8,["modelValue","error","error-message"]),o(c,{color:"primary",label:"Register",loading:e.user.state.isLoading,type:"submit"},null,8,["loading"]),o(c,{color:"primary",label:"Back",outline:"",type:"reset",onClick:e.onBack},null,8,["onClick"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(v,{modelValue:e.showErrorDialog,"onUpdate:modelValue":r[6]||(r[6]=t=>e.showErrorDialog=t)},{default:l(()=>[o(C,{class:"q-pa-md",style:{"max-width":"400px",width:"400px"}},{default:l(()=>[o(d,null,{default:l(()=>[o(W,{color:"negative",icon:"o_warning_amber","text-color":"white"}),re]),_:1}),o(d,{class:"row items-center"},{default:l(()=>[n("div",{class:"q-pr-xl",innerHTML:e.errorMessage},null,8,oe)]),_:1}),o(S,{align:"right"},{default:l(()=>[L(o(c,{color:"primary",label:"CLOSE",outline:"",onClick:r[5]||(r[5]=t=>e.showErrorDialog=!1)},null,512),[[H]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const Ge=M(Y,[["render",ae]]);export{Ge as default};
