import{Q as m,a as $}from"./QCardActions-DFoPz7zY.js";import{Q as d}from"./QInput-B7T_tnQa.js";import{Q as p}from"./QBtn-eBFPfLou.js";import{Q as v}from"./QForm-Bqnz71c4.js";import{Q as w,a as C}from"./QAvatar-BgjoEnj_.js";import{Q as h}from"./QDialog-B9Qz0xnL.js";import{Q as V}from"./QPage-Dnb37Vze.js";import{C as y}from"./ClosePopup-C2kcMQSb.js";import"./isTypedArray-V6sIBVz1.js";import{A as b,M as Q}from"./Api-BM-Yc0hw.js";import{r as n,m as c,e as k,s as E}from"./index-Cdbtwfsg.js";import{http as A,auth as M}from"./apis-Di_SAPwX.js";import{u as f}from"./Auth-Bo1jILJ9.js";import{a0 as S,q as D,d as L,_ as U,o as q,c as B,u as a,K as o,a2 as F,J as i,L as P}from"./index-BgKJ_Ot-.js";import{a as N}from"./http-CAOryOOa.js";import"./render-BF43JfyS.js";import"./use-file-dom-props-CUBVuoqU.js";import"./QSpinner-Cw__CG3n.js";import"./use-dark-BJYpCXgG.js";import"./focus-manager-BJWzFvJg.js";import"./use-key-composition-CHHzdI92.js";import"./dom-CvelUQUV.js";import"./vm-B61G6sTM.js";import"./use-prevent-scroll-DIEeThiC.js";import"./scroll-CIRf0LJU.js";import"./use-timeout-CCLfrWGs.js";import"./focusout-CywNIEFb.js";import"./use-model-toggle-HdP93Opv.js";import"./Action-BeMcUDL_.js";import"./index-lSnk7GHB.js";const{Axios:Qe,AxiosError:H,CanceledError:ke,isCancel:Ee,CancelToken:Ae,VERSION:Me,all:Se,Cancel:De,isAxiosError:Le,spread:Ue,toFormData:qe,AxiosHeaders:Be,HttpStatusCode:Fe,formToJSON:Pe,getAdapter:Ne,mergeConfig:He}=N;class g extends b{resource="users";constructor(){super()}static me(){const e=new g;return new Promise((t,u)=>{A.get("/api/v1/users/me").then(async l=>{e.retrieved(l.data),t(l.data)}).catch(l=>{e.retrievingError(l),console.error(l),u(l)})})}retrieved(e){console.log(e);const t=f();t.user=e.data}stored(e){console.log(e);const t=f();t.user=e.data,M.token=e.token}updated(e){console.log(e);const t=f();t.user=e.data}}class O extends Q{api=g;model=S({id:void 0,created_at:void 0,updated_at:void 0,deleted_at:void 0,name:void 0,email:void 0,password:void 0,passwordConfirmation:void 0,token:void 0});constructor(e){super(),this.factory(e),super.initValidations()}validations=D(()=>({model:{name:{required:n,minLength:c(8)},email:{email:k,required:n},password:{required:n,minLengthValue:c(6)},passwordConfirmation:{required:n,sameAsPassword:E(this.model.password)}}}))}const R=L({setup(){return{user:new O}},data(){return{open:!0,showErrorDialog:!1,errorMessage:""}},methods:{onBack(){this.$router.go(-1)},async submitForm(){if(this.user.$validate(),console.log(this.user.$model),!this.user.$invalid)try{const{actioned:r,model:e}=await this.user.save();console.log(r,e),this.$router.push({path:"/"})}catch(r){const e=new H(r).message.error.error.error.response;console.error("#postForm","error",e),e.status===422?(this.errorMessage="",Object.keys(e.data.error).forEach((t,u)=>{e.data.error[t].forEach(l=>{this.errorMessage+=l+" "}),this.errorMessage+="<br><br>"})):this.errorMessage="Unknown error",this.showErrorDialog=!0}}}}),T=i("div",{id:"register-form-title",class:"text-h6"},"Register",-1),I={class:"q-pa-md"},J={class:"q-gutter-y-md column",style:{"max-width":"400px"}},j=i("div",{class:"text-h6",style:{display:"inline","margin-left":"10px"}},"Sorry, an error happened",-1),K=["innerHTML"];function z(r,e,t,u,l,G){return q(),B(V,null,{default:a(()=>[o(h,{modelValue:r.open,"onUpdate:modelValue":e[4]||(e[4]=s=>r.open=s),persistent:""},{default:a(()=>[o(w,{style:{width:"400px"}},{default:a(()=>[o(m,null,{default:a(()=>[T]),_:1}),o(m,{class:"q-pt-none"},{default:a(()=>[o(v,{ref:"registerForm",onSubmit:F(r.submitForm,["prevent"])},{default:a(()=>[i("div",I,[i("div",J,[o(d,{ref:"name",modelValue:r.user.model.name,"onUpdate:modelValue":e[0]||(e[0]=s=>r.user.model.name=s),error:r.user.$model.name.$error,"error-message":r.user.$model.name.$errors[0]?.$message,label:"Full Name",name:"name",outlined:""},null,8,["modelValue","error","error-message"]),o(d,{ref:"email",modelValue:r.user.model.email,"onUpdate:modelValue":e[1]||(e[1]=s=>r.user.model.email=s),error:r.user.$model.email.$error,"error-message":r.user.$model.email.$errors[0]?.$message,label:"E-Mail Address",name:"email",outlined:""},null,8,["modelValue","error","error-message"]),o(d,{ref:"password",modelValue:r.user.model.password,"onUpdate:modelValue":e[2]||(e[2]=s=>r.user.model.password=s),error:r.user.$model.password.$error,"error-message":r.user.$model.password.$errors[0]?.$message,label:"Password",name:"password",outlined:"",type:"password"},null,8,["modelValue","error","error-message"]),o(d,{ref:"passwordConfirmation",modelValue:r.user.model.passwordConfirmation,"onUpdate:modelValue":e[3]||(e[3]=s=>r.user.model.passwordConfirmation=s),error:r.user.$model.passwordConfirmation.$error,"error-message":r.user.$model.passwordConfirmation.$errors[0]?.$message,label:"Confirm Password",name:"passwordConfirmation",outlined:"",type:"password"},null,8,["modelValue","error","error-message"]),o(p,{color:"primary",label:"Register",loading:r.user.state.isLoading,type:"submit"},null,8,["loading"]),o(p,{color:"primary",label:"Back",outline:"",type:"reset",onClick:r.onBack},null,8,["onClick"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(h,{modelValue:r.showErrorDialog,"onUpdate:modelValue":e[6]||(e[6]=s=>r.showErrorDialog=s)},{default:a(()=>[o(w,{class:"q-pa-md",style:{"max-width":"400px",width:"400px"}},{default:a(()=>[o(m,null,{default:a(()=>[o(C,{color:"negative",icon:"o_warning_amber","text-color":"white"}),j]),_:1}),o(m,{class:"row items-center"},{default:a(()=>[i("div",{class:"q-pr-xl",innerHTML:r.errorMessage},null,8,K)]),_:1}),o($,{align:"right"},{default:a(()=>[P(o(p,{color:"primary",label:"CLOSE",outline:"",onClick:e[5]||(e[5]=s=>r.showErrorDialog=!1)},null,512),[[y]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const Oe=U(R,[["render",z]]);export{Oe as default};
